# でたとこサーガ用1行キャラシ出力ツール ver1.0

[![Build Status](https://travis-ci.org/koi-chan/detatoko-1line-charasheet.svg?branch=master)](https://travis-ci.org/koi-chan/detatoko-1line-charasheet)

[でたとこサーガ](http://detatoko-saga.com/) で使える、1行で表現されたキャラクターシートです。  
GM がキー判定を決めるときに、PL が他のキャラクターの支援をするときに、パッと見て PC の状態が分かります。

アイディア元はSW2などのプレイサイト [月光華亭](http://geekou.net/) の「技能表」です。

## 出力データ解説

```
名前        |Lv|体力　気力 旗|クラス　|スキル　　　|意感交肉技知|ID  |プレイヤー
王道勇者    |１|11/11 10/10 0|勇者戦士|聖希折鉄強必|１１　４　　|   1|でたとこサーガ
暗黒魔王    |１|10/10 11/11 0|魔王暗黒|無圧極ド暗愉|３１１　　１|   2|でたとこサーガ
```

_名前_ と _Lv_ の項目は説明がなくとも問題ないでしょう。

_体力・気力_ は、分子・分母のどちらにも、常に最大値が出力されます。  
_「旗」_ はフラグのことで、こちらは常に0が出力されます。

_クラス_ は 15(公式キャラシは対応していないため出力されないが、サプリ「でたとこファンタジア」掲載の3クラスにも対応) 全て2文字に短縮して出力されます。

_スキル_ は「アタック」「モノローグ」「ガード」を除いた6つの、それぞれの頭文字を出力します。掲載順に並べ替えられています。

続く項目は _スキルジャンル_ の集計結果です。  
順に「意志」「感覚」「交渉」「肉体」「技術」「知識」を表しています。

_ID_ はキャラクターシートのIDです。  
_プレイヤー_ はキャラクターシートの登録者名です。


## 同梱ファイル

このリポジトリに含まれるファイルの一覧です。

### detatoko_1line_charasheet.rb

中核となるファイルです。  
[公式が提供しているオンラインキャラクターシート](http://detatoko-saga.com/character/) の JSON 出力機能からデータを取得し、整形します。

他のフロントエンドから呼び出されて機能します。単体では動作しません。  
外部ライブラリとして lib/string.rb 及び、組み込みライブラリ「JSON」「net/http」を利用します。

### detatoko_1line_charasheet.cgi

CGI として動作させるためのファイルです。  
フロントエンドですので、単体では動作しません。

### shell.rb

シェルから呼び出して実行するためのファイルです。  
CGI 用と同様に、単体では動作しません。 

### lib/string.rb

組み込みクラス String を拡張するライブラリです。


## 動作環境

動作確認を行なっている環境は以下の通りです。

### Ruby

* 1.9.3
* 2.0.0
* 2.1.7
* 2.2.3

### ウェブサーバ

* Apache 2.4.6 (CentOS 7.1: httpd-2.4.6-31.el7.centos.1.x86_64)

### ブラウザ

* Firefox 40.0.3


## 使い方

### CGI 編

1. Ruby インタプリタのパスを調べ、detatoko_1line_charasheet.cgi の1行目を書き換えます。  
レンタルホームページスペースのマニュアルなどを確認してください。
2. 次のファイル・ディレクトリをレンタルホームページスペースなどにアップロードします。  
  * detatoko_1line_charasheet.rb
  * detatoko_1line_charasheet.cgi
  * lib/
3. detatoko_1line_charasheet.cgi のパーミッションを変更します。大抵は 755 (rwx-r-xr-x) ですが、レンタルスペースによっては 705 などの場合もあります。
4. 動作確認を行ないます。

### シェル編

shell.rb を実行します。引数として、出力したいキャラクターシートのIDを指定します。  
キャラクターシートのIDはURLから調べることができます。  
例: http://detatoko-saga.com/character/1  
末尾に書かれた数字がIDです。このURLの場合、IDは 1 となります。  
コマンド例としては以下の通りです。

```
ruby shell.rb 1
```
